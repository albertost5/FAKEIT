{% extends 'base.html.twig' %}

{% block title %}FAKEIT - Shop
{% endblock %}


{# NAVBAR #}
{% block nav %}
	{{ include('navbar/mainnavbar.html.twig') }}
{% endblock %}


{% block body %}
	
	<div class="container-fluid" id="shopbg" style="padding-top: 310px;">
		<div class="row text-center" style="margin-top: -180px;">
			<div class="col-12">
				<h1>
					<img src="/img/navbar/fakeit.svg" width="30" height="40" class="rotate180" alt="Fakeit-Logo">
					<b>FAKEIT SHOP</b>
				</h1>
			</div>
		</div>
	</div>

	<hr class="w-999">
	{% if user.activated == 1 %}
		<div class="row no-mlr mt-5">
			<div class="col-sm-12 col-md-6 col-lg-6 col-xl-3">
				<div class="card bg-fkgray text-white fk-card mx-auto">
					<div class="card-body text-center">
						<img src="/img/shop/changeicon.jpg" alt="nickchange" width="100" height="100">
						<h5 class="card-title">
							<b>NICK CHANGE</b>
						</h5>
						<p class="card-text mt-10">Al adquirir este item, cambia tu nickname.</p>
						<p class="card-text fakeit">
							<b>F</b>
							300
						</p>
						<div class="text-center">
							<a href="#" class="btn btn-primary" id="change-item" data-toggle="modal" data-target="#nick-modal" {% if not b300 == true %} style="pointer-events: none; background-color: grey; border: 1px solid grey;" {% endif %}>Comprar</a>
						</div>
					</div>
				</div>
			</div>

			<div class="col-sm-12 col-md-6 col-lg-6 col-xl-3">
				
				<div class="card bg-fkgray text-white fk-card mx-auto">
					<div class="card-body text-center">
						<img src="/img/shop/logo1.png" alt="boostone" width="100" height="100">
						<h5 class="card-title">
							<b>BOOST ONE</b>
						</h5>
						<p class="card-text mt-10">Al adquirir este item, aumenta tu nivel una vez.</p>
						<p class="card-text fakeit">
							<b>F</b>
							150
						</p>
						<div class="text-center">
							<a href="#" class="btn btn-primary" id="one-item" data-toggle="modal" data-target="#boostOne-modal" {% if not b150 or user.level == 10 %} style="pointer-events: none; background-color: grey; border: 1px solid grey;" {% endif %}>Comprar</a>
						</div>
					</div>
				</div>
			</div>

			<div class="col-sm-12 col-md-6 col-lg-6 col-xl-3">
				<div class="card bg-fkgray text-white fk-card mx-auto">
					<div class="card-body text-center">
						<img src="/img/shop/logo2.png" alt="boosttwo" width="100" height="100">
						<h5 class="card-title">
							<b>BOOST TWO</b>
						</h5>
						<p class="card-text mt-10">Al adquirir este item, aumenta tu nivel dos veces.</p>
						<p class="card-text fakeit">
							<b>F</b>
							200
						</p>
						<div class="text-center">
							<a href="#" class="btn btn-primary" id="two-item" data-toggle="modal" data-target="#boostTwo-modal" {% if not b200 or user.level >= 9 %} style="pointer-events: none; background-color: grey; border: 1px solid grey;" {% endif %}>Comprar</a>
						</div>
					</div>
				</div>
			</div>

			<div class="col-sm-12 col-md-6 col-lg-6 col-xl-3">
				<div class="card bg-fkgray text-white fk-card mx-auto">
					<div class="card-body text-center">
						<img src="/img/shop/pay.jpg" alt="free" width="100" height="100">
						<h5 class="card-title">
							<b>FREE ELO</b>
						</h5>
						<p class="card-text mt-10">Al adquirir este item, aumenta el elo en 25.</p>
						<p class="card-text fakeit">
							<b>F</b>
							50
						</p>
						<div class="text-center">
							<a href="#" class="btn btn-primary" id="elo-item" data-toggle="modal" data-target="#elo-modal" {% if not b50 %} style="pointer-events: none; background-color: grey; border: 1px solid grey;" {% endif %}>Comprar</a>
						</div>
					</div>
				</div>
			</div>

			{# MODALES#}
			<div class="modal fade mt-100" id="elo-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog fakeit" role="document">
					<div class="modal-content bg-fkgray text-center">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLabel">ELO ITEM</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body white">
							¿Estás seguro de comprar el item ELO?
						</div>

						<div class="modal-footer">
							<a href="#" class="btn btn-secondary" data-dismiss="modal">NO</a>
							<a href="{{ path('buy_item', {'cost': 50}) }}" class="btn btn-primary">SI</a>
						</div>
					</div>
				</div>
			</div>

			<div class="modal fade mt-100" id="boostOne-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog fakeit" role="document">
					<div class="modal-content bg-fkgray text-center">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLabel">BOOST ONE ITEM</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body white">
							¿Estás seguro de comprar el item BOOST ONE?
						</div>

						<div class="modal-footer">
							<a href="#" class="btn btn-secondary" data-dismiss="modal">NO</a>
							<a href="{{ path('buy_item', {'cost': 150}) }}" class="btn btn-primary">SI</a>
						</div>
					</div>
				</div>
			</div>

			<div class="modal fade mt-100" id="boostTwo-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog fakeit" role="document">
					<div class="modal-content bg-fkgray text-center">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLabel">BOOST ONE ITEM</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body white">
							¿Estás seguro de comprar el item BOOST TWO?
						</div>

						<div class="modal-footer">
							<a href="#" class="btn btn-secondary" data-dismiss="modal">NO</a>
							<a href="{{ path('buy_item', {'cost': 200}) }}" class="btn btn-primary">SI</a>
						</div>
					</div>
				</div>
			</div>

			<div class="modal fade mt-100" id="nick-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog fakeit" role="document">
					<div class="modal-content bg-fkgray text-center">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLabel">NICK CHANGE</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body white">
							Escribe el nuevo nick:
						</div>
						<div id="modal-nick">
							<input id="newNick"></input>
							<button class="btn btn-primary" id="searchName" {# onclick="checkName()" #}>
								<i class="fas fa-search"></i>
							</button>
							<br/>
							<br/>
							<div class="alert alert-danger alert-dismissible fade show" role="alert" id="message">
							</div>
						</div>
						<div class="modal-footer" id="modal-confirm">
							¿Desea cambiar su nick? 
							<a href="#" class="btn btn-secondary" data-dismiss="modal" disabled>NO</a>
							<a href="#" id="nickconfirm" class="btn btn-primary" disabled>SI</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	{% else %}
		<div class="row no-mlr pd-tb-40 mt-5">
            <div class="col-1 col-sm-2 col-md-2 col-lg-2 col-xl-3"></div>
            <div class="col-10 col-sm-10 col-md-8 col-lg-8 col-xl-6 text-center">
                <div class="alert alert-warning" role="alert">
                    CONTACTE CON EL ADMINISTRADOR PARA REACTIVAR LA CUENTA
                </div>
            <div class="col-1 col-sm-2 col-md-2 col-lg-2 col-xl-3"></div>
        </div>
	{% endif %}
{% endblock %}

{% block javascripts %}
	<script>
		$("#change-item").on("click", function(){
			$("div#message").hide();
			$("#newNick").val("");
			$("div#modal-confirm").hide();
		});

		$("#newNick").focus(function() {
			if($("div#modal-confirm").is(":visible")){
				$("div#modal-confirm").hide(); 
			}
		});

		$("#searchName").on("click", function() {	 
			var nicks = [];
			var nickUser = "";

			{% for u in usersall %}
				nickUser = "{{u.nick}}".toLowerCase();
				nicks.push(nickUser);
			{% endfor %}	

			var newName = $("#newNick").val();
			$("div#message").show();

			if(newName == ""){
				if($("div#message").hasClass("alert-success")){
					$("div#message").removeClass("alert-success").addClass("alert-danger");
				}
				$("div#message").html("El nick no puede estar vacío.");
			}else{
				if(($.inArray(newName.toLowerCase(), nicks) == -1)){
					// NICK AVAILABLE
					if(newName.length >= 4 && newName.length <= 10){
						if($("div#message").hasClass("alert-danger")){
							$("div#message").removeClass("alert-danger").addClass("alert-success");
						}
						$("div#message").html("El nick "+newName+", está disponible.");
						$("div#modal-confirm").show();
						$("a#nickconfirm").attr("href", "http://localhost:8000/buy/change/"+newName);
						console.log($("a#nickconfirm").attr('href'));
					}else{
						if($("div#message").hasClass("alert-success")){
							$("div#message").removeClass("alert-success").addClass("alert-danger");
						}
						$("div#message").html("El nick ha contener 4 o 10 carácteres.");
					}
				}else{
					// NICK NOT AVAILABLE
					if($("div#message").hasClass("alert-success")){
						$("div#message").removeClass("alert-success").addClass("alert-danger");
					}
					$("div#message").html("El nick "+newName+", no está disponible.");
				}
			}
		});
	</script>

{% endblock %}



